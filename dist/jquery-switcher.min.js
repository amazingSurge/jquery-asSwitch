/*! Itoggle - v0.1.0 - 2013-07-23
* https://github.com/amazingSurge/jquery-switcher
* Copyright (c) 2013 joeylin; Licensed MIT */
(function(t){"use strict";var i=t.switcher=function(e,s){this.$input=t(e).wrap("<div></div>"),this.$element=this.$input.parent();var n={disabled:this.$input.prop("disabled"),checked:this.$input.prop("checked")};this.options=t.extend({},i.defaults,s,n),this.namespace=this.options.namespace,this.$element.addClass(this.namespace).addClass(this.options.skin),this.checked=this.options.checked,this.enabled=!0,this.initial=!1,this._click=!0,this.init()};i.prototype={constuctor:i,init:function(){var i=this.options;this.$inner=t('<div class="'+this.namespace+'-inner"></div>'),this.$innerBox=t('<div class="'+this.namespace+'-inner-box"></div>'),this.$on=t('<div class="'+this.namespace+'-on">'+i.ontext+"</div>"),this.$off=t('<div class="'+this.namespace+'-off">'+i.offtext+"</div>"),this.$handle=t('<div class="'+this.namespace+'-handle"></div>'),this.$innerBox.append(this.$on,this.$off),this.$inner.append(this.$innerBox),this.$element.append(this.$inner,this.$handle);var e=this.$on.width(),s=this.$handle.width();this.distance=e-s/2,this.options.clickable===!0&&this.$element.on("click touchstart",t.proxy(this.click,this)),this.options.dragable===!0&&(this.$handle.on("mousedown touchstart",t.proxy(this.mousedown,this)),this.$handle.on("click",function(){return!1})),this.set(this.checked),this.initial=!0},animate:function(t,i){return this.initial===!1?(this.$innerBox.css({marginLeft:t}),this.$handle.css({left:this.distance+t}),!1):(this.$innerBox.stop().animate({marginLeft:t},{duration:this.options.animation,complete:i}),this.$handle.stop().animate({left:this.distance+t},{duration:this.options.animation}),void 0)},getDragPos:function(t){return t.pageX||(t.originalEvent.changedTouches?t.originalEvent.changedTouches[0].pageX:0)},move:function(t){t=Math.max(-this.distance,Math.min(t,0)),this.$innerBox.css({marginLeft:t}),this.$handle.css({left:this.distance+t})},click:function(){return this._click===!1?(this._click=!0,!1):(this.checked===!0?this.set(!1):this.set(!0),!1)},mousedown:function(i){var e,s=this,n=this.getDragPos(i);if(this.enabled!==!1)return this.mousemove=function(t){var i=this.getDragPos(t);return e=this.checked===!0?i-n>0?0:-this.distance>i-n?-this.distance:i-n:0>i-n?-this.distance:i-n>this.distance?0:-this.distance+i-n,this.move(e),this.$handle.off("mouseup"),!1},this.mouseup=function(){var i=parseInt(this.$innerBox.css("margin-left"),10);return Math.abs(i)>=this.distance/2&&this.set(!1),Math.abs(i)<this.distance/2&&this.set(!0),t(document).off({mousemove:this.mousemove,mouseup:this.mouseup,touchmove:this.mousemove,touchend:this.mouseup}),this.$handle.off("mouseup"),!1},t(document).on({mousemove:t.proxy(this.mousemove,this),mouseup:t.proxy(this.mouseup,this),touchmove:t.proxy(this.mousemove,this),touchend:t.proxy(this.mouseup,this)}),this.options.clickable===!0&&this.$handle.on("mouseup touchend",function(){s.checked===!0?s.set(!1):s.set(!0),s.$handle.off("mouseup touchend"),t(document).off({mousemove:this.mousemove,mouseup:this.mouseup,touchmove:this.mousemove,touchend:this.mouseup})}),!1},check:function(){return this.set(!0),this},uncheck:function(){return this.set(!1),this},set:function(t){if(this.enabled!==!1){switch(t){case!0:this.checked=t,this.$input.trigger("checked"),this.$input.prop("checked",!0),this.animate(0);break;case!1:this.checked=t,this.$input.trigger("unchecked"),this.$input.prop("checked",!1),this.animate(-this.distance)}return this}},get:function(){return this.$input.prop("checked")},enable:function(){return this.enabled=!0,this.$element.addClass(this.namespace+"-enabled"),this},disable:function(){return this.enabled=!1,this.$element.removeClass(this.namespace+"-enabled"),this},destroy:function(){this.$element.off("click touchstart"),this.$handle.off("mousedown touchstart")}},i.defaults={skin:"skin-8",dragable:!0,clickable:!0,disabled:!1,ontext:"ON",offtext:"OFF",checked:!0,animation:200,namespace:"switch"},t.fn.switcher=function(e){return this.each(function(){t.data(this,"switcher")||t.data(this,"switcher",new i(this,e))})}})(jQuery);